<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>ruby code</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="/stylesheets/snippets.css?1229957682" media="screen" rel="Stylesheet" type="text/css" />
    <link href="/stylesheets/minitabs.css?1229957682" media="screen" rel="Stylesheet" type="text/css" />

    <!--[if IE]>
    <link href="/stylesheets/iefixes.css?1229957682" media="screen" rel="Stylesheet" type="text/css" />
    <![endif]-->
    <!-- Use this code block to activate a prestitial if there's one to load -->
<!-- BEGIN ADVERTPRO ADVANCED CODE BLOCK -->

<SCRIPT language="JavaScript" type="text/javascript">
<!--
document.write('<SCR'+'IPT src="http://avpa.javalobby.org/servlet/view/dynamic/javascript/zone?zid=159&pid=0&random='+Math.floor(89999999*Math.random()+10000000)+'&millis='+new Date().getTime()+'" language="JavaScript" type="text/javascript"></SCR'+'IPT>');
//-->
</SCRIPT>

<!-- END ADVERTPRO ADVANCED CODE BLOCK -->
</head>

<body class="normal" id="none">
    <div id="container">
      <div id="header">
	<form action="/account/login" method="post">
	    <div id="functions">
	    <a href="/account/signup">Create account</a> or Username: <input id="username" name="username" type="text" /> Password: <input id="password" name="password" type="password" /> <input name="commit" type="submit" value="Log In" /><br />
         <!-- BEGIN ADVERTPRO ADVANCED CODE BLOCK -->

<!-- b style="background-color: #f5f; border-top: solid 1px #660; border-bottom: solid 1px #660; padding: 4px" -->
<!-- %= link_to 'Get your coding job seen by 130,000 coders', :controller => 'ads', :action => 'new' % -->
<!-- /b -->
	    </div>
	</form>
	<p id="title">
    <a href="http://snippets.dzone.com/">DZone Snippets</a>
    
     &gt; <a href="/tag/ruby">ruby</a>
</p><p><em>15736 users tagging and storing useful source code snippets</em></p>
	<!-- p><em>Post code snippets. Sort by tags, people, people and tags, etc..</em></p -->
</div>

      



      


<div id="sidebar">
    <div class="inner">
                   <div id="search_snippets" class="box green">
            <h3>Search DZone Snippets</h3>
            <form action="/search/get_results" method="get">
                <input type="text" name="q" value="" size="20"> <input type="submit" value="Search"/>
            </form>
        </div>
               <div id="mediumRect" class="box">
            <!-- BEGIN ADVERTPRO ADVANCED CODE BLOCK -->

<SCRIPT language="JavaScript" type="text/javascript">
<!--
document.write('<SCR'+'IPT src="http://avpa.javalobby.org/servlet/view/banner/javascript/zone?zid=83&pid=0&random='+Math.floor(89999999*Math.random()+10000000)+'&millis='+new Date().getTime()+'" language="JavaScript" type="text/javascript"></SCR'+'IPT>');
//-->
</SCRIPT>
<NOSCRIPT>
<A href="http://avpa.javalobby.org/servlet/click/zone?zid=83&pid=0&lookup=true&position=1" target="_top">
<IMG src="http://avpa.javalobby.org/servlet/view/banner/image/zone?zid=83&pid=0&position=1" height="250" width="300" hspace="0" vspace="0" border="0" alt="Click Here!">
</A>
</NOSCRIPT>

<!-- END ADVERTPRO ADVANCED CODE BLOCK -->
        </div>
               

        <div id="dzone_latest" class="box blue">
            <h3>Popular @ <a href="http://www.dzone.com">dzone.com</a></h3>
            
                        <p><a href="http://www.dzone.com/links/rss/what_is_platform_as_a_service_paas_2.html" title="What Is Platform as a Service (PaaS)?">
                           What Is Platform as a Service (PaaS)?</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/101_purely_awesome_404_error_pages.html" title="101 Purely Awesome 404 Error Pages">
                           101 Purely Awesome 404 Error Pages</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/the_rise_of_virtual_service_grids.html" title="The Rise of Virtual Service Grids">
                           The Rise of Virtual Service Grids</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/15_open_source_content_management_systems_vote_fo.html" title="15 Open Source Content Management Systems - Vote For Your Favorite And Win">
                           15 Open Source Content Management Systems - Vot...</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/lets_fork_beansbinding.html" title="Let's fork BeansBinding">
                           Let's fork BeansBinding</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/the_devil_is_in_the_details.html" title="The devil is in the details">
                           The devil is in the details</a></p>
            
                        <p><a href="http://www.dzone.com/links/rss/top_5_netbeans_platform_students_projects_from_li.html" title="Top 5 NetBeans Platform Students Projects from Linz, Austria">
                           Top 5 NetBeans Platform Students Projects from ...</a></p>
            
        </div>

        
        
        <div class="box green">
            <h3>Related Tags</h3>
            <p>
                
                <a href="/tag/ruby" class="tag ">ruby</a> (1321)<br /><a href="/tag/rails" class="tag ">rails</a> (275)<br /><a href="/tag/array" class="tag ">array</a> (71)<br /><a href="/tag/xml" class="tag ">xml</a> (67)<br /><a href="/tag/rubyonrails" class="tag ">rubyonrails</a> (57)<br /><a href="/tag/string" class="tag ">string</a> (52)<br /><a href="/tag/hash" class="tag ">hash</a> (50)<br /><a href="/tag/regex" class="tag ">regex</a> (48)<br /><a href="/tag/file" class="tag ">file</a> (45)<br /><a href="/tag/rexml" class="tag ">rexml</a> (43)<br /><a href="/tag/activerecord" class="tag ">activerecord</a> (41)<br /><a href="/tag/html" class="tag ">html</a> (28)<br /><a href="/tag/web" class="tag ">web</a> (28)<br /><a href="/tag/random" class="tag ">random</a> (28)<br /><a href="/tag/text" class="tag ">text</a> (26)<br /><a href="/tag/http" class="tag ">http</a> (22)<br /><a href="/tag/windows" class="tag ">windows</a> (22)<br /><a href="/tag/time" class="tag ">time</a> (21)<br /><a href="/tag/xmpp" class="tag ">xmpp</a> (21)<br /><a href="/tag/gtk" class="tag ">gtk</a> (20)<br /><a href="/tag/rake" class="tag ">rake</a> (19)<br /><a href="/tag/date" class="tag ">date</a> (19)<br /><a href="/tag/rss" class="tag ">rss</a> (17)<br /><a href="/tag/shell" class="tag ">shell</a> (17)<br /><a href="/tag/simple" class="tag ">simple</a> (16)<br /><a href="/tag/url" class="tag ">url</a> (16)<br /><a href="/tag/search" class="tag ">search</a> (15)<br /><a href="/tag/server" class="tag ">server</a> (15)<br /><a href="/tag/projectx" class="tag ">projectx</a> (14)<br /><a href="/tag/convert" class="tag ">convert</a> (14)<br /><a href="/tag/helper" class="tag ">helper</a> (14)<br /><a href="/tag/method" class="tag ">method</a> (14)<br /><a href="/tag/math" class="tag ">math</a> (14)<br /><a href="/tag/google" class="tag ">google</a> (14)<br /><a href="/tag/class" class="tag ">class</a> (13)<br /><a href="/tag/cgi" class="tag ">cgi</a> (12)<br /><a href="/tag/api" class="tag ">api</a> (12)<br /><a href="/tag/testing" class="tag ">testing</a> (12)<br /><a href="/tag/sql" class="tag ">sql</a> (12)<br /><a href="/tag/mysql" class="tag ">mysql</a> (12)<br /><a href="/tag/javascript" class="tag ">javascript</a> (12)<br /><a href="/tag/link" class="tag ">link</a> (11)<br /><a href="/tag/regexp" class="tag ">regexp</a> (11)<br /><a href="/tag/xslt" class="tag ">xslt</a> (11)<br /><a href="/tag/object" class="tag ">object</a> (11)<br /><a href="/tag/rmagick" class="tag ">rmagick</a> (11)<br /><a href="/tag/osx" class="tag ">osx</a> (11)<br /><a href="/tag/pattern" class="tag ">pattern</a> (11)<br /><a href="/tag/twitter" class="tag ">twitter</a> (11)<br /><a href="/tag/metaprogramming" class="tag ">metaprogramming</a> (11)<br />
                
            </p>
        </div>
        
        
        
        
    </div>
</div>

<div id="main">
    <div id="leaderboard">
    <SCRIPT language="JavaScript" type="text/javascript">
    <!--
    document.write('<SCR'+'IPT src="http://avpa.javalobby.org/servlet/view/banner/javascript/zone?zid=91&pid=0&random='+Math.floor(89999999*Math.random()+10000000)+'&millis='+new Date().getTime()+'" language="JavaScript" type="text/javascript"></SCR'+'IPT>');
    //-->
    </SCRIPT>
    <NOSCRIPT>
    <A href="http://avpa.javalobby.org/servlet/click/zone?zid=91&pid=0&lookup=true&position=1" target="_top">
    <IMG src="http://avpa.javalobby.org/servlet/view/banner/image/zone?zid=91&pid=0&position=1" height="90" width="728" hspace="0" vspace="0" border="0" alt="Click Here!">
    </A>
    </NOSCRIPT>
    <!-- END ADVERTPRO ADVANCED CODE BLOCK -->
</div>
      
    
        <div class="green box">
            <h3>Never been to DZone Snippets before?</h3>
            <p><b>Snippets is a <span class='highlighted'>public source code repository.</span></b> Easily build up your personal collection of code snippets, categorize them with tags / keywords, and share them with the world</p>
        </div>
        
    
    

<!--     -->
        


<div class="box grey paginator" style="text-align: center; color: #fff"><div style="float: left">
    <span class="disabled">&laquo; Newer Snippets</span></div><div style="float: right">
    <a href="/tag/ruby/2">Older Snippets &raquo;</a></div>Showing 1-10 of 1291 total <a title="RSS 2.0" href="/rss/tag/ruby"><span style="border:1px solid;border-color:#FC9 #630 #330 #F96;padding:1px 4px;font:bold 11px verdana,sans-serif;color:#FFF;background:#F60;text-decoration:none;margin:0px">&nbsp;RSS&nbsp;</span></a><br />
<div style="margin-top: 8px; "><form action="#"><select style="width: 250px" onchange="JumpToIt(this)">
 
 <option value="#post7102">Iterate through hash items in order</option>
 
 <option value="#post7099">module.lsp</option>
 
 <option value="#post7098">module.lsp</option>
 
 <option value="#post7088">Validate a TLD with Ruby</option>
 
 <option value="#post7086">chmodding and Ruby</option>
 
 <option value="#post7085">Scrape the 1st paragragh from a Wikipedia entry</option>
 
 <option value="#post7084">Strip the extra space out of a string using Ruby</option>
 
 <option value="#post7077">Retrieve a person's age from Wikipedia using Ruby</option>
 
 <option value="#post7059">Convert a Google Spreadsheet to XML</option>
 
 <option value="#post7048">Generate a Google Chart with gchartrb</option>
 
 </select></form>
     </div>

</div>





<div id="posts">
	<a name="post7102"></a>

<div id="post7102">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7102">Iterate through hash items in order</a></h3>

		<div class="post-body">Source: <a href="http://www.ruby-forum.com/topic/133324">Hash Sorting - Ruby Forum</a> [ruby-forum.com]<br /><br />You may have noticed the following from the Ruby Hash documentation:<br />&lt;snip&gt;<br />The order in which you traverse a hash by either key or value may seem arbitrary, and will generally not be in the insertion order.<br />&lt;/snip&gt;<br /><br />Here is how you can sort the hash order:<br /><pre>
<span class="ident">h</span> <span class="punct">=</span> <span class="punct">{}</span>
<span class="ident">h</span><span class="punct">[&quot;</span><span class="string">abc</span><span class="punct">&quot;]</span> <span class="punct">=</span> <span class="number">123</span>
<span class="ident">h</span><span class="punct">[&quot;</span><span class="string">def</span><span class="punct">&quot;]</span> <span class="punct">=</span> <span class="number">876</span>
<span class="ident">h</span><span class="punct">[&quot;</span><span class="string">ghi</span><span class="punct">&quot;]</span> <span class="punct">=</span> <span class="number">567</span>

<span class="ident">h</span><span class="punct">.</span><span class="ident">keys</span><span class="punct">.</span><span class="ident">sort</span><span class="punct">.</span><span class="ident">each</span> <span class="punct">{|</span><span class="ident">key</span><span class="punct">|</span>
  <span class="ident">puts</span> <span class="ident">h</span><span class="punct">[</span><span class="ident">key</span><span class="punct">]</span>
<span class="punct">}</span>
</pre><br /><br />output:<br /><pre><br />123<br />876<br />567<br />=&gt; ["abc", "def", "ghi"]<br /></pre><br /><br />Resources:<br /> - <a href="http://www.ruby-doc.org/core/classes/Hash.html">Class: Hash</a> [ruby-doc.org]</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/hash" class="tag ">hash</a> <a href="/tag/sort" class="tag ">sort</a>  <!-- (47) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 25, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7099"></a>

<div id="post7099">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7099">module.lsp</a></h3>

		<div class="post-body">// Finally!<br /><br /><pre>
<span class="comment">#!/usr/bin/env newlisp</span>

<span class="punct">;;</span> <span class="constant">Calls</span> <span class="ident">main</span> <span class="ident">only</span> <span class="keyword">if</span> <span class="ident">this</span> <span class="ident">script</span> <span class="ident">is</span> <span class="ident">being</span> <span class="ident">run</span> <span class="ident">by</span> <span class="ident">itself</span><span class="punct">,</span>
<span class="punct">;;</span> <span class="keyword">not</span> <span class="keyword">if</span> <span class="ident">this</span> <span class="ident">script</span> <span class="ident">is</span> <span class="ident">being</span> <span class="ident">loaded</span> <span class="ident">by</span> <span class="ident">another</span><span class="punct">.</span>

<span class="punct">(</span><span class="ident">define</span> <span class="punct">(</span><span class="ident">main</span><span class="punct">)</span>
   <span class="punct">;;</span> <span class="punct">...</span>

   <span class="punct">(</span><span class="ident">exit</span><span class="punct">))</span>

<span class="punct">(</span><span class="keyword">if</span> <span class="punct">(</span><span class="ident">regex</span> <span class="punct">&quot;</span><span class="string">module</span><span class="punct">&quot;</span> <span class="punct">(</span><span class="ident">string</span> <span class="punct">(</span><span class="ident">main</span><span class="punct">-</span><span class="ident">args</span> <span class="number">1</span><span class="punct">)))</span> <span class="punct">(</span><span class="ident">main</span><span class="punct">))</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/python" class="tag ">python</a> <a href="/tag/module" class="tag ">module</a> <a href="/tag/lisp" class="tag ">lisp</a> <a href="/tag/script" class="tag ">script</a> <a href="/tag/newlisp" class="tag ">newlisp</a> <a href="/tag/main" class="tag ">main</a>  <!-- (61) --> by <a href="/user/mcandre">mcandre</a> on Mar 25, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7098"></a>

<div id="post7098">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7098">module.lsp</a></h3>

		<div class="post-body">// Finally, a way to only execute if this is the script being run. An equivalent to Python's<br />//<br />// if __name__=="__main__":<br />//    main()<br />//<br />// and Ruby's<br />//<br />// if __FILE__==$0<br />//    main<br />// end<br /><br /><pre>
<span class="comment">#!/usr/bin/env newlisp</span>

<span class="punct">;;</span> <span class="constant">Calls</span> <span class="ident">main</span> <span class="ident">only</span> <span class="keyword">if</span> <span class="ident">this</span> <span class="ident">script</span> <span class="ident">is</span> <span class="ident">being</span> <span class="ident">run</span> <span class="ident">by</span> <span class="ident">itself</span><span class="punct">,</span>
<span class="punct">;;</span> <span class="keyword">not</span> <span class="keyword">if</span> <span class="ident">this</span> <span class="ident">script</span> <span class="ident">is</span> <span class="ident">being</span> <span class="ident">loaded</span> <span class="ident">by</span> <span class="ident">another</span><span class="punct">.</span>

<span class="punct">(</span><span class="ident">define</span> <span class="punct">(</span><span class="ident">main</span><span class="punct">)</span>
	<span class="punct">;;</span> <span class="punct">...</span>

	<span class="punct">(</span><span class="ident">exit</span><span class="punct">))</span>

<span class="punct">(</span><span class="keyword">if</span> <span class="punct">(</span><span class="ident">regex</span> <span class="punct">&quot;</span><span class="string">module</span><span class="punct">&quot;</span> <span class="punct">(</span><span class="ident">string</span> <span class="punct">(</span><span class="ident">main</span><span class="punct">-</span><span class="ident">args</span> <span class="number">1</span><span class="punct">)))</span> <span class="punct">(</span><span class="ident">main</span><span class="punct">))</span>
</pre></div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/python" class="tag ">python</a> <a href="/tag/module" class="tag ">module</a> <a href="/tag/lisp" class="tag ">lisp</a> <a href="/tag/script" class="tag ">script</a> <a href="/tag/newlisp" class="tag ">newlisp</a> <a href="/tag/main" class="tag ">main</a>  <!-- (59) --> by <a href="/user/mcandre">mcandre</a> on Mar 25, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7088"></a>

<div id="post7088">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7088">Validate a TLD with Ruby</a></h3>

		<div class="post-body">Source: <a href="http://www.google.com/codesearch/p?hl=en#F1g7qSOvazo/README.txt&amp;q=tld%20ruby">TLD</a> [google.com]<br /><br />Provides meta information for Internet Top Level Domains (TLDs) such as a<br />descriptive name, associated currency code and the TLD category.<br /><br /><pre>
<span class="ident">require</span> <span class="punct">'</span><span class="string">rubygems</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">tld</span><span class="punct">'</span>

<span class="constant">TLD</span><span class="punct">.</span><span class="ident">find</span><span class="punct">('</span><span class="string">foo.com.au</span><span class="punct">').</span><span class="ident">name</span> <span class="comment">#=&gt; &quot;Australia&quot;</span>
<span class="constant">TLD</span><span class="punct">.</span><span class="ident">find</span><span class="punct">('</span><span class="string">is.gd</span><span class="punct">').</span><span class="ident">name</span> <span class="comment">#=&gt; &quot;Grenada&quot;</span>
<span class="constant">TLD</span><span class="punct">.</span><span class="ident">find</span><span class="punct">('</span><span class="string">deli.cio.us</span><span class="punct">').</span><span class="ident">name</span>  <span class="comment">#=&gt; &quot;United States&quot;</span>
</pre><br /><br />To install the gem:<br /><pre><br />gem install alexrabarts-tld -s http://gems.github.com<br /><br />Bulk updating Gem source index for: http://gems.github.com<br />Install required dependency alexrabarts-iso_country_codes? [Yn]  y<br />Successfully installed alexrabarts-tld-0.2.1<br />Successfully installed alexrabarts-iso_country_codes-0.2.1<br />Installing ri documentation for alexrabarts-tld-0.2.1...<br />Installing ri documentation for alexrabarts-iso_country_codes-0.2.1...<br />Installing RDoc documentation for alexrabarts-tld-0.2.1...<br />Installing RDoc documentation for alexrabarts-iso_country_codes-0.2.1...<br /></pre><br /><br />Resources:<br /> - <a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/68191">[ANN] tld.rb 0.11 - Check wether a given TLD is valid or not</a> [nagaokaut.ac.jp]</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/valid" class="tag ">valid</a> <a href="/tag/validate" class="tag ">validate</a> <a href="/tag/tld" class="tag ">tld</a>  <!-- (42) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 23, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7086"></a>

<div id="post7086">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7086">chmodding and Ruby</a></h3>

		<div class="post-body">Recently, I switched from a Powerbook to a Macbook, and to copy my files from one to the other, I used a pen drive. Since my pen drive has a FAT file system, it treats everything as being executable. This, however, is not the case on a UNIX-like file system like OS X. In order to save myself the hassle of manually chmodding thousands of files, I wrote this Ruby script:<br /><br /><pre>
<span class="comment">#!/usr/bin/env ruby</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">find</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">fileutils</span><span class="punct">'</span>

<span class="comment"># Append to/remove from this list as necessary</span>
<span class="constant">Plain</span> <span class="punct">=</span> <span class="punct">['</span><span class="string">php</span><span class="punct">',</span> <span class="punct">'</span><span class="string">txt</span><span class="punct">',</span> <span class="punct">'</span><span class="string">jpg</span><span class="punct">',</span> <span class="punct">'</span><span class="string">jpeg</span><span class="punct">',</span> <span class="punct">'</span><span class="string">gif</span><span class="punct">',</span> <span class="punct">'</span><span class="string">png</span><span class="punct">',</span> <span class="punct">'</span><span class="string">html</span><span class="punct">',</span> <span class="punct">'</span><span class="string">pdf</span><span class="punct">',</span> <span class="punct">'</span><span class="string">css</span><span class="punct">',</span> <span class="punct">'</span><span class="string">mp3</span><span class="punct">',</span> <span class="punct">'</span><span class="string">zip</span><span class="punct">',</span> <span class="punct">'</span><span class="string">tar.gz</span><span class="punct">',</span> <span class="punct">'</span><span class="string">tar</span><span class="punct">',</span> <span class="punct">'</span><span class="string">htm</span><span class="punct">',</span> <span class="punct">'</span><span class="string">psd</span><span class="punct">',</span> <span class="punct">'</span><span class="string">ai</span><span class="punct">',</span> <span class="punct">'</span><span class="string">ptg</span><span class="punct">',</span> <span class="punct">'</span><span class="string">cgi.pl</span><span class="punct">',</span> <span class="punct">'</span><span class="string">sphp</span><span class="punct">',</span> <span class="punct">'</span><span class="string">svn-base</span><span class="punct">',</span> <span class="punct">'</span><span class="string">default</span><span class="punct">'].</span><span class="ident">collect</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">ext</span><span class="punct">|</span>
    <span class="punct">&quot;</span><span class="string">.<span class="expr">#{ext}</span></span><span class="punct">&quot;</span>
<span class="keyword">end</span><span class="punct">.</span><span class="ident">freeze</span>

<span class="comment"># Append to/remove from this list as necessary</span>
<span class="constant">Executable</span> <span class="punct">=</span> <span class="punct">['</span><span class="string">pl</span><span class="punct">',</span> <span class="punct">'</span><span class="string">rb</span><span class="punct">',</span> <span class="punct">'</span><span class="string">cgi</span><span class="punct">',</span> <span class="punct">'</span><span class="string">sh</span><span class="punct">'].</span><span class="ident">collect</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">ext</span><span class="punct">|</span>
    <span class="punct">&quot;</span><span class="string">.<span class="expr">#{ext}</span></span><span class="punct">&quot;</span>
<span class="keyword">end</span><span class="punct">.</span><span class="ident">freeze</span>
<span class="global">$num_chmodded</span> <span class="punct">=</span> <span class="number">0</span>

<span class="keyword">def </span><span class="method">chmod_and_puts</span><span class="punct">(</span> <span class="ident">cmd</span> <span class="punct">)</span>
    <span class="ident">puts</span> <span class="ident">cmd</span>
    <span class="ident">system</span> <span class="ident">cmd</span>
    <span class="global">$num_chmodded</span> <span class="punct">+=</span> <span class="number">1</span>
<span class="keyword">end</span>

<span class="keyword">def </span><span class="method">chmodder</span><span class="punct">(</span> <span class="ident">start_dir</span> <span class="punct">)</span>
    <span class="ident">num_skipped</span> <span class="punct">=</span> <span class="number">0</span>
    <span class="ident">num_plain</span> <span class="punct">=</span> <span class="number">0</span>
    <span class="ident">num_executable</span> <span class="punct">=</span> <span class="number">0</span>
   
    <span class="constant">Find</span><span class="punct">.</span><span class="ident">find</span><span class="punct">(</span> <span class="ident">start_dir</span> <span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">path</span><span class="punct">|</span>
        <span class="keyword">unless</span> <span class="constant">File</span><span class="punct">.</span><span class="ident">symlink?</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">)</span>
            <span class="keyword">if</span> <span class="constant">FileTest</span><span class="punct">.</span><span class="ident">file?</span> <span class="ident">path</span>
                <span class="keyword">if</span> <span class="ident">is_plain?</span> <span class="ident">path</span>
                    <span class="ident">chmod_and_puts</span> <span class="punct">&quot;</span><span class="string">chmod 644 <span class="escape">\&quot;</span><span class="expr">#{path}</span><span class="escape">\&quot;</span></span><span class="punct">&quot;</span>
                    <span class="ident">num_plain</span> <span class="punct">+=</span> <span class="number">1</span>
                <span class="keyword">elsif</span> <span class="ident">is_executable?</span> <span class="ident">path</span>
                    <span class="ident">chmod_and_puts</span> <span class="punct">&quot;</span><span class="string">chmod 755 <span class="escape">\&quot;</span><span class="expr">#{path}</span><span class="escape">\&quot;</span></span><span class="punct">&quot;</span>
                    <span class="ident">num_executable</span> <span class="punct">+=</span> <span class="number">1</span>
                <span class="keyword">else</span>
                    <span class="ident">num_skipped</span> <span class="punct">+=</span> <span class="number">1</span>
                <span class="keyword">end</span>
            <span class="keyword">elsif</span> <span class="constant">File</span><span class="punct">.</span><span class="ident">directory?</span> <span class="ident">path</span>
                <span class="ident">chmod_and_puts</span> <span class="punct">&quot;</span><span class="string">chmod 755 <span class="escape">\&quot;</span><span class="expr">#{path}</span><span class="escape">\&quot;</span></span><span class="punct">&quot;</span>
                <span class="ident">num_executable</span> <span class="punct">+=</span> <span class="number">1</span>
            <span class="keyword">else</span>
                <span class="ident">num_skipped</span> <span class="punct">+=</span> <span class="number">1</span>
            <span class="keyword">end</span>
        <span class="keyword">else</span>
            <span class="ident">num_skipped</span> <span class="punct">+=</span> <span class="number">1</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
   
    <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">----------------------------------------------</span><span class="punct">&quot;</span>
    <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Chmodded <span class="expr">#{$num_chmodded}</span> total:</span><span class="punct">&quot;</span>
    <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\t</span>Executable: <span class="expr">#{num_executable}</span></span><span class="punct">&quot;</span>
    <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\t</span>Plain: <span class="expr">#{num_plain}</span></span><span class="punct">&quot;</span>
    <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Skipped <span class="expr">#{num_skipped}</span> files/directories/symlinks</span><span class="punct">&quot;</span>
<span class="keyword">end</span>

<span class="keyword">def </span><span class="method">get_extension</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">)</span>
    <span class="constant">File</span><span class="punct">.</span><span class="ident">extname</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">).</span><span class="ident">downcase</span>
<span class="keyword">end</span>

<span class="keyword">def </span><span class="method">is_executable?</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">)</span>
    <span class="ident">extension</span> <span class="punct">=</span> <span class="ident">get_extension</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">)</span>
   
    <span class="keyword">if</span> <span class="constant">Executable</span><span class="punct">.</span><span class="ident">include?</span> <span class="ident">extension</span>
        <span class="constant">true</span>
    <span class="keyword">else</span>
        <span class="constant">false</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">def </span><span class="method">is_plain?</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">)</span>
    <span class="ident">extension</span> <span class="punct">=</span> <span class="ident">get_extension</span><span class="punct">(</span> <span class="ident">path</span> <span class="punct">)</span>
   
    <span class="keyword">if</span> <span class="constant">Plain</span><span class="punct">.</span><span class="ident">include?</span> <span class="ident">extension</span>
        <span class="constant">true</span>
    <span class="keyword">else</span>
        <span class="constant">false</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">chmodder</span><span class="punct">(</span> <span class="punct">'</span><span class="string">.</span><span class="punct">'</span> <span class="punct">)</span>
</pre><br /><br />This goes through all the files and directories within the directory from which you run the script and chmods non-executable files to 644 (read+write on User, read on Group and Other) and executable files to 755 (read+write+execute on User, read+execute on Group and Other).</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/linux" class="tag ">linux</a> <a href="/tag/find" class="tag ">find</a> <a href="/tag/recursive" class="tag ">recursive</a> <a href="/tag/path" class="tag ">path</a> <a href="/tag/file" class="tag ">file</a> <a href="/tag/permissions" class="tag ">permissions</a> <a href="/tag/chmod" class="tag ">chmod</a>  <!-- (53) --> by <a href="/user/moneypenny">moneypenny</a> on Mar 23, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7085"></a>

<div id="post7085">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7085">Scrape the 1st paragragh from a Wikipedia entry</a></h3>

		<div class="post-body">This is a Ruby script to fetch information (in 140 characters or less) from Wikipedia for use with my XMPP bot (drobertson) on identica.<br /><br /><pre>
<span class="ident">puts</span> <span class="ident">ask_wikipedia_about</span><span class="punct">('</span><span class="string">Boris Yeltsin</span><span class="punct">')</span>
<span class="ident">puts</span> <span class="ident">ask_wikipedia_about</span><span class="punct">('</span><span class="string">Information Card</span><span class="punct">')</span>
<span class="ident">puts</span> <span class="ident">ask_wikipedia_about</span><span class="punct">('</span><span class="string">Paul Allen</span><span class="punct">')</span>

<span class="keyword">def </span><span class="method">ask_wikipedia_about</span><span class="punct">(</span><span class="ident">query</span><span class="punct">)</span>
  <span class="ident">page_title</span><span class="punct">,</span> <span class="ident">uri_title</span> <span class="punct">=</span> <span class="ident">get_wiki_name</span><span class="punct">(</span><span class="ident">query</span><span class="punct">)</span>
  <span class="ident">uri_title</span><span class="punct">.</span><span class="ident">length</span> <span class="punct">&gt;</span> <span class="number">0</span> <span class="punct">?</span> <span class="ident">get_wiki_description</span><span class="punct">(</span><span class="ident">page_title</span><span class="punct">,</span> <span class="ident">uri_title</span><span class="punct">)</span> <span class="punct">:</span> <span class="punct">&quot;</span><span class="string">search result not found</span><span class="punct">&quot;</span>
<span class="keyword">end</span>

</pre><br />output:<br /><pre><br />#=&gt; Boris Nikolayevich Yeltsin was the first President of the Russian Federation,<br /> serving from 1991 to 1999.<br /><br />#=&gt; Information Cards are personal digital identities that people can use online.<br /><br />#=&gt; Paul Gardner Allen is an American entrepreneur who co-founded Microsoft with <br /> Bill Gates and is one of the wealthiest peopl ...<br /><br /></pre><br /><br />Here's the script to scrape the 1st paragraph from the Wikipedia entry.<br /><pre>
<span class="keyword">def </span><span class="method">get_wiki_description</span><span class="punct">(</span><span class="ident">page_title</span><span class="punct">,</span> <span class="ident">uri_title</span><span class="punct">)</span>
  <span class="ident">url</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">http://en.wikipedia.org/wiki/</span><span class="punct">'</span> <span class="punct">+</span> <span class="ident">uri_title</span>
  <span class="ident">buffer</span> <span class="punct">=</span> <span class="ident">open</span><span class="punct">(</span><span class="ident">url</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">UserAgent</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Ruby-Wikipedia Reader</span><span class="punct">&quot;).</span><span class="ident">read</span>
  
  <span class="comment"># look for the page title (or fragments of the title) in the paragraph  </span>
  <span class="ident">a1</span> <span class="punct">=</span>  <span class="ident">buffer</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">table&gt;<span class="escape">\n</span>&lt;p&gt;&lt;b&gt;.*<span class="expr">#{page_title.split(' ').join('.*')}</span></span><span class="punct">/</span>

  <span class="ident">a1</span> <span class="punct">+=</span> <span class="number">7</span>
  
  <span class="comment"># capture the 1st paragraph and anything which follows</span>
  <span class="ident">b1</span> <span class="punct">=</span> <span class="ident">buffer</span><span class="punct">.</span><span class="ident">slice</span><span class="punct">(</span><span class="ident">a1</span><span class="punct">,</span> <span class="ident">buffer</span><span class="punct">.</span><span class="ident">length</span> <span class="punct">-</span> <span class="ident">a1</span><span class="punct">)</span>

  <span class="comment"># strip out HTML tags, other brackets, and extra spaces</span>
  <span class="ident">a</span> <span class="punct">=</span> <span class="ident">b1</span><span class="punct">.</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex">&lt;<span class="escape">\/</span>?[^&gt;]*&gt;</span><span class="punct">/,</span> <span class="punct">'</span><span class="string"></span><span class="punct">').</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex">&amp;#<span class="escape">\d</span>+;</span><span class="punct">/,'</span><span class="string"></span><span class="punct">').</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex"><span class="escape">\(</span>[^<span class="escape">\)</span>]+<span class="escape">\)</span></span><span class="punct">/,'</span><span class="string"></span><span class="punct">').</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex"><span class="escape">\[</span>[^<span class="escape">\]</span>]+<span class="escape">\]</span></span><span class="punct">/,'</span><span class="string"></span><span class="punct">').</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex"> +</span><span class="punct">/,'</span><span class="string"> </span><span class="punct">')</span>
 
  <span class="comment"># trim the text down to 126 characters</span>
  <span class="ident">b</span> <span class="punct">=</span> <span class="ident">a</span><span class="punct">.</span><span class="ident">slice</span><span class="punct">(</span><span class="number">0</span><span class="punct">,</span><span class="number">126</span><span class="punct">)</span>

  <span class="comment"># look for the full stop, and if found cut the text at that point</span>
  <span class="comment">#   otherwise look for the comma or semi-colon.</span>

  <span class="ident">full_stop</span> <span class="punct">=</span> <span class="ident">b</span><span class="punct">.</span><span class="ident">reverse</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex"><span class="escape">\.</span></span><span class="punct">/</span>

  <span class="keyword">if</span> <span class="ident">full_stop</span> <span class="keyword">and</span> <span class="ident">full_stop</span> <span class="punct">&lt;</span> <span class="number">60</span> <span class="keyword">then</span>
    <span class="ident">c</span> <span class="punct">=</span>  <span class="ident">b</span><span class="punct">.</span><span class="ident">slice</span><span class="punct">(</span><span class="number">0</span><span class="punct">,</span><span class="ident">b</span><span class="punct">.</span><span class="ident">length</span> <span class="punct">-</span> <span class="ident">full_stop</span><span class="punct">)</span>

  <span class="keyword">else</span>

    <span class="ident">bcount</span> <span class="punct">=</span> <span class="punct">(</span><span class="ident">b</span><span class="punct">.</span><span class="ident">reverse</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">,|;</span><span class="punct">/)</span> 
    <span class="keyword">if</span> <span class="ident">bcount</span> <span class="keyword">and</span> <span class="ident">bcount</span> <span class="punct">&lt;</span> <span class="number">50</span>
      <span class="ident">c</span> <span class="punct">=</span> <span class="ident">b</span><span class="punct">.</span><span class="ident">slice</span><span class="punct">(</span><span class="number">0</span><span class="punct">,</span> <span class="ident">b</span><span class="punct">.</span><span class="ident">length</span> <span class="punct">-</span> <span class="ident">bcount</span> <span class="punct">-</span> <span class="number">1</span><span class="punct">)</span> <span class="punct">+</span> <span class="punct">'</span><span class="string"> ...</span><span class="punct">'</span>
    <span class="keyword">else</span>
      <span class="ident">c</span> <span class="punct">=</span> <span class="ident">a</span><span class="punct">.</span><span class="ident">slice</span><span class="punct">(</span><span class="number">0</span><span class="punct">,</span> <span class="number">122</span><span class="punct">)</span> <span class="punct">+</span> <span class="punct">'</span><span class="string"> ...</span><span class="punct">'</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
  <span class="ident">c</span>
<span class="keyword">end</span>
</pre><br /><br />This script fetches the Wikipedia URL from the initial keyword search.<br /><pre>
<span class="comment"># use live.com search to help us find wikipedia article</span>
<span class="comment">#</span>
<span class="keyword">def </span><span class="method">get_wiki_name</span><span class="punct">(</span><span class="ident">query_item</span><span class="punct">)</span>
  <span class="ident">wiki_name</span> <span class="punct">=</span> <span class="punct">'</span><span class="string"></span><span class="punct">'</span>
  <span class="ident">keywords</span> <span class="punct">=</span> <span class="ident">query_item</span>

  <span class="ident">search_keywords</span> <span class="punct">=</span> <span class="ident">keywords</span><span class="punct">.</span><span class="ident">strip</span><span class="punct">.</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex"><span class="escape">\s</span>+</span><span class="punct">/,'</span><span class="string">+</span><span class="punct">')</span>

  <span class="ident">url</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">http://search.live.com/results.aspx?q=<span class="expr">#{search_keywords}</span>+site%3Aen.wikipedia.org&amp;amp;go=&amp;amp;form=QBLH&amp;amp;format=rss&amp;format=rss</span><span class="punct">&quot;</span>
  <span class="ident">doc</span> <span class="punct">=</span> <span class="constant">Document</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">open</span><span class="punct">(</span><span class="ident">url</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">UserAgent</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Ruby-Wikipedia Reader</span><span class="punct">&quot;).</span><span class="ident">read</span><span class="punct">)</span>

  <span class="ident">node</span> <span class="punct">=</span> <span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">['</span><span class="string">channel/item[1]</span><span class="punct">']</span>
  <span class="keyword">if</span> <span class="ident">node</span>
    <span class="keyword">return</span> <span class="ident">node</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">title</span><span class="punct">')[/</span><span class="regex">^([^-]+)<span class="escape">\s</span>-<span class="escape">\s</span>Wiki</span><span class="punct">/,</span><span class="number">1</span><span class="punct">],</span> <span class="ident">node</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">link</span><span class="punct">')[/</span><span class="regex">[^<span class="escape">\/</span>]+$</span><span class="punct">/]</span>
  <span class="keyword">else</span>
    <span class="comment">#puts &quot;that search didn't work &quot;</span>
    <span class="keyword">return</span> <span class="punct">'</span><span class="string"></span><span class="punct">','</span><span class="string"></span><span class="punct">'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><br /><br />Resources:<br /> - <a href="http://snippets.dzone.com/posts/show/7077">Retrieve a person's age from Wikipedia using Ruby</a> [dzone.com]</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/about" class="tag ">about</a> <a href="/tag/scrape" class="tag ">scrape</a> <a href="/tag/article" class="tag ">article</a> <a href="/tag/wikipedia" class="tag ">wikipedia</a> <a href="/tag/paragraph" class="tag ">paragraph</a>  <!-- (69) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 23, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7084"></a>

<div id="post7084">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7084">Strip the extra space out of a string using Ruby</a></h3>

		<div class="post-body">Source: <a href="http://www.ruby-forum.com/topic/175336">Q: most efficient way to remove duplicate spaces in a string? - Ruby Forum</a> [ruby-forum.com]<br /><pre>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">current  position is  eighth in the list</span><span class="punct">&quot;.</span><span class="ident">gsub</span><span class="punct">(/</span><span class="regex"> +</span><span class="punct">/,'</span><span class="string"> </span><span class="punct">')</span>
</pre><br />output:<br /><pre><br />curent position is eighth in the list<br /></pre></div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/regex" class="tag ">regex</a> <a href="/tag/string" class="tag ">string</a> <a href="/tag/space" class="tag ">space</a> <a href="/tag/regexp" class="tag ">regexp</a> <a href="/tag/remove" class="tag ">remove</a> <a href="/tag/duplicate" class="tag ">duplicate</a> <a href="/tag/spaces" class="tag ">spaces</a> <a href="/tag/blank" class="tag ">blank</a>  <!-- (37) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 23, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7077"></a>

<div id="post7077">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7077">Retrieve a person's age from Wikipedia using Ruby</a></h3>

		<div class="post-body"><pre>
<span class="ident">require</span> <span class="punct">'</span><span class="string">open-uri</span><span class="punct">'</span>

<span class="comment"># retrieve the person's age</span>
<span class="comment">#</span>
<span class="keyword">def </span><span class="method">age</span><span class="punct">(</span><span class="ident">person</span><span class="punct">)</span>
  <span class="ident">url</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">http://en.wikipedia.org/wiki/</span><span class="punct">'</span> <span class="punct">+</span> <span class="ident">person</span>
  <span class="ident">open</span><span class="punct">(</span><span class="ident">url</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">UserAgent</span><span class="punct">&quot;</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">Ruby-Wikipedia Reader</span><span class="punct">&quot;).</span><span class="ident">read</span><span class="punct">[/</span><span class="regex"><span class="escape">\(</span>aged?&amp;#160;(<span class="escape">\d</span>+)<span class="escape">\)</span></span><span class="punct">/,</span><span class="number">1</span><span class="punct">]</span>
<span class="keyword">end</span>

<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Jimmy Saville is <span class="expr">#{age('Jimmy_Saville')}</span> years old</span><span class="punct">&quot;</span>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Barack Obama is <span class="expr">#{age('Barack_Obama')}</span> years old</span><span class="punct">&quot;</span>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Marilyn Monroe was <span class="expr">#{age('Marilyn_Monroe')}</span> years old</span><span class="punct">&quot;</span>
</pre><br />output:<br /><pre><br />Jimmy Saville is 82 years old<br />Barack Obama is 47 years old<br />Marilyn Monroe was 36 years old<br /></pre><br /><br />Resources:<br /> - <a href="http://dbpedia.org/About">wiki.dbpedia.org : About</a> [dbpedia.org]<br /> - <a href="http://bit.ly/lhz3X">Tim Berners-Lee: The next Web of open, linked data</a> [youtube.com]</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/regex" class="tag ">regex</a> <a href="/tag/regexp" class="tag ">regexp</a> <a href="/tag/age" class="tag ">age</a> <a href="/tag/scrape" class="tag ">scrape</a> <a href="/tag/scraping" class="tag ">scraping</a> <a href="/tag/wikipedia" class="tag ">wikipedia</a>  <!-- (70) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 21, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7059"></a>

<div id="post7059">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7059">Convert a Google Spreadsheet to XML</a></h3>

		<div class="post-body">While browsing the Guardian Data Store page <a href="http://www.guardian.co.uk/news/datablog/2009/mar/01/health-health-and-wellbeing">How much do we exercise?</a> [guardian.co.uk] I was interested how I could convert the spreadsheet <a href="http://spreadsheets.google.com/pub?key=phNtm3LmDZEOzUFQpbVB-Vg">Exercise among adults - Google Docs</a> [google.com] into an XML file which would make it easier to read (in something like a simple Ruby script).<br /><br />I started out with sketching out how I wanted the <a href="http://rorbuilder.info/exercise_draft.xml?passthru=1">XML structure</a>[rorbuilder.info].<br /><br />Then I wrote an xml template to help read the specific sheet cells (as shown below in gs:map). <br /><pre>
<span class="ident">map</span> <span class="punct">=&lt;&lt;</span><span class="constant">MAP</span><span class="string">
&lt;gs:map xmlns:gs=&quot;http://schemas.rorbuilder.info/spreadsheets/2009/extended&quot;&gt;
  &lt;gs:sheet&gt;
    &lt;gs:summary&gt;
      &lt;gs:summary_name&gt;A8+&lt;/gs:summary_name&gt;
      &lt;no_time/&gt;
      &lt;any/&gt;
      &lt;less_than_1/&gt;
      &lt;c_1_less_than_3/&gt;
      &lt;c_3_less_than_5/&gt;
      &lt;c_5_less_than_7/&gt;
      &lt;c_7_or_more/&gt;
      &lt;mean_no_of_hours/&gt;
      &lt;gs:step&gt;1&lt;/gs:step&gt;
      &lt;gs:repeat&gt;5&lt;/gs:repeat&gt;
      &lt;gs:template&gt;activity&lt;/gs:template&gt;
      &lt;gs:sheet_country&gt;a4&lt;/gs:sheet_country&gt;
      &lt;gs:sheet_description&gt;a1&lt;/gs:sheet_description&gt;
      &lt;gs:sheet_metric&gt;g4&lt;/gs:sheet_metric&gt;
    &lt;/gs:summary&gt;
    &lt;gs:records&gt;
      &lt;gs:block_col&gt;
        &lt;gs:start&gt;c9&lt;/gs:start&gt;&lt;gender_type&gt;c5&lt;/gender_type&gt;&lt;year_title&gt;c6&lt;/year_title&gt;
      &lt;/gs:block_col&gt;
      &lt;gs:block_col&gt;
        &lt;gs:start&gt;d9&lt;/gs:start&gt;&lt;gender_type&gt;c5&lt;/gender_type&gt;&lt;year_title&gt;d6&lt;/year_title&gt;
      &lt;/gs:block_col&gt;        
      &lt;gs:block_col&gt;
        &lt;gs:start&gt;f9&lt;/gs:start&gt;&lt;gender_type&gt;f5&lt;/gender_type&gt;&lt;year_title&gt;f6&lt;/year_title&gt;
      &lt;/gs:block_col&gt;        
      &lt;gs:block_col&gt;
        &lt;gs:start&gt;g9&lt;/gs:start&gt;&lt;gender_type&gt;f5&lt;/gender_type&gt;&lt;year_title&gt;g6&lt;/year_title&gt;
      &lt;/gs:block_col&gt;        
    &lt;/gs:records&gt;
  &lt;/gs:sheet&gt;
&lt;/gs:map&gt;
</span><span class="constant">MAP</span>
</pre><br /><br />The following code reads the google spreadsheet as an xml document, reads the xml map, and writes an easy to use xml file.<br /><pre>
<span class="keyword">def </span><span class="method">append_sections</span><span class="punct">(</span><span class="ident">doc</span><span class="punct">,</span> <span class="ident">doc_cellfeed</span><span class="punct">,</span> <span class="ident">parent_records</span><span class="punct">,</span> <span class="ident">block_col</span><span class="punct">)</span>
  <span class="comment"># while reading the current block (e.g. Male 2008) get the starting </span>
  <span class="comment">#   cell value for the column</span>
  <span class="ident">start_point</span> <span class="punct">=</span> <span class="ident">block_col</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">gs:start</span><span class="punct">').</span><span class="ident">to_s</span>

  <span class="comment"># convert that cell adress into the X, and Y numeric address</span>
  <span class="ident">start_col</span><span class="punct">,</span> <span class="ident">start_row</span> <span class="punct">=</span> <span class="ident">get_colrow</span><span class="punct">(</span><span class="ident">start_point</span><span class="punct">)</span>

  <span class="comment"># get the start summary name value</span>
  <span class="ident">sn_cell</span> <span class="punct">=</span> <span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">gs:sheet/gs:summary/gs:summary_name</span><span class="punct">')[/</span><span class="regex">.*(?=<span class="escape">\+</span>)</span><span class="punct">/]</span>
  <span class="comment"># convert the summary name address into X, and Y numeric address</span>
  <span class="ident">title_col</span><span class="punct">,</span> <span class="ident">title_row</span> <span class="punct">=</span> <span class="ident">get_colrow</span><span class="punct">(</span><span class="ident">sn_cell</span><span class="punct">)</span>    

  <span class="comment"># total the no. of measurements in the activity</span>
  <span class="ident">e1</span> <span class="punct">=</span> <span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">.</span><span class="ident">each</span><span class="punct">(&quot;</span><span class="string">gs:sheet/gs:summary/*[not(starts-with(name(),'gs:'))]</span><span class="punct">&quot;){}.</span><span class="ident">to_a</span><span class="punct">.</span><span class="ident">length</span>

  <span class="comment"># get the vertical cell step between activities.</span>
  <span class="ident">step</span> <span class="punct">=</span> <span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">gs:sheet/gs:summary/gs:step</span><span class="punct">')</span>

  <span class="comment"># total the no. of activity measurements including the step</span>
  <span class="ident">section_step</span> <span class="punct">=</span> <span class="ident">e1</span> <span class="punct">+</span> <span class="ident">step</span><span class="punct">.</span><span class="ident">to_i</span>

  <span class="comment"># retrieve the no. of activities per block</span>
  <span class="ident">section_count</span> <span class="punct">=</span> <span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">gs:sheet/gs:summary/gs:repeat</span><span class="punct">').</span><span class="ident">to_i</span>

  <span class="comment"># initalise the row counter for the activity label</span>
  <span class="ident">current_row</span> <span class="punct">=</span> <span class="ident">title_row</span><span class="punct">.</span><span class="ident">to_i</span>


  <span class="punct">(</span><span class="number">1</span><span class="punct">..</span><span class="ident">section_count</span><span class="punct">).</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">i</span><span class="punct">|</span>
    
    <span class="comment"># create the activity element</span>
    <span class="ident">ps_name</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">gs:name</span><span class="punct">')</span>
    
    <span class="comment"># set the next summary name cell address</span>
    <span class="ident">sn_cell</span> <span class="punct">=</span> <span class="ident">title_col</span> <span class="punct">+</span> <span class="ident">current_row</span><span class="punct">.</span><span class="ident">to_s</span>

    <span class="comment">#retrieve the activity name</span>
    <span class="ident">ps_name</span><span class="punct">.</span><span class="ident">text</span> <span class="punct">=</span> <span class="ident">doc_cellfeed</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">(&quot;</span><span class="string">entry[title='<span class="expr">#{sn_cell.upcase}</span>']/gs:cell</span><span class="punct">&quot;).</span><span class="ident">to_s</span>
    
    <span class="comment"># create the parent element for the block's section ('activity')</span>
    <span class="ident">parent_col</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">('</span><span class="string">gs:sheet/gs:summary/gs:template</span><span class="punct">'))</span>
    
    <span class="comment"># append the gs:name to the activity</span>
    <span class="ident">parent_col</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">ps_name</span>

    <span class="comment"># initialise the axtivity measurement row position</span>
    <span class="ident">i</span> <span class="punct">=</span> <span class="number">0</span>
    
    <span class="comment"># iterate through each activity measurement item</span>
    <span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">.</span><span class="ident">each</span><span class="punct">(&quot;</span><span class="string">gs:sheet/gs:summary/*[not(starts-with(name(),'gs:'))]</span><span class="punct">&quot;)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">summary_node</span><span class="punct">|</span>
      <span class="comment"># create the element using the activity measurement label</span>
      <span class="ident">colval</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">summary_node</span><span class="punct">.</span><span class="ident">name</span><span class="punct">)</span>
      
      <span class="comment"># define the next cell address to read</span>
      <span class="ident">next_point</span> <span class="punct">=</span> <span class="ident">start_col</span> <span class="punct">+</span> <span class="punct">(</span><span class="ident">start_row</span><span class="punct">.</span><span class="ident">to_i</span> <span class="punct">+</span> <span class="ident">i</span><span class="punct">).</span><span class="ident">to_s</span>
        
      <span class="comment"># retrieve the activity measurement node</span>
      <span class="ident">cell</span> <span class="punct">=</span> <span class="ident">doc_cellfeed</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">[&quot;</span><span class="string">entry[title='<span class="expr">#{next_point.upcase}</span>']/gs:cell</span><span class="punct">&quot;]</span>

      <span class="comment"># if the cell is valid</span>
      <span class="keyword">if</span> <span class="ident">cell</span> <span class="keyword">then</span>
        <span class="comment"># retrieve the activity measurement node value</span>
        <span class="ident">colval</span><span class="punct">.</span><span class="ident">text</span> <span class="punct">=</span> <span class="ident">cell</span><span class="punct">.</span><span class="ident">text</span><span class="punct">.</span><span class="ident">to_s</span>
        
        <span class="comment"># add the measurement node to the activity node</span>
        <span class="ident">parent_col</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">colval</span>
      <span class="keyword">end</span>        
      
      <span class="ident">i</span> <span class="punct">+=</span> <span class="number">1</span>
    <span class="keyword">end</span>

    <span class="comment"># increment the label row</span>
    <span class="ident">current_row</span> <span class="punct">+=</span> <span class="ident">section_step</span> <span class="punct">+</span> <span class="number">1</span>
    
    <span class="comment"># increent the measurement activity row</span>
    <span class="ident">start_row</span> <span class="punct">+=</span> <span class="ident">section_step</span> <span class="punct">+</span> <span class="number">1</span>
    
    <span class="comment"># add the activity node to the 'records' node</span>
    <span class="ident">parent_records</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">parent_col</span>
    
  <span class="keyword">end</span>
<span class="keyword">end</span>



<span class="ident">doc</span> <span class="punct">=</span> <span class="constant">Document</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">map</span><span class="punct">)</span>

<span class="ident">root_records</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">records</span><span class="punct">')</span>
<span class="ident">parent</span> <span class="punct">=</span> <span class="ident">root_records</span>
<span class="ident">prev_parent_text</span> <span class="punct">=</span> <span class="punct">'</span><span class="string"></span><span class="punct">'</span>

<span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">.</span><span class="ident">each</span><span class="punct">(&quot;</span><span class="string">gs:sheet/gs:records/gs:block_col</span><span class="punct">&quot;)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">block_col</span><span class="punct">|</span>

  <span class="ident">base_node</span> <span class="punct">=</span> <span class="ident">block_col</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">[&quot;</span><span class="string">*[not(starts-with(name(),'gs:'))]</span><span class="punct">&quot;]</span>

  <span class="keyword">if</span> <span class="ident">base_node</span><span class="punct">.</span><span class="ident">text</span><span class="punct">.</span><span class="ident">to_s</span> <span class="punct">!=</span> <span class="ident">prev_parent_text</span> <span class="keyword">then</span>
    <span class="ident">parent</span> <span class="punct">=</span> <span class="ident">root_records</span>
  <span class="keyword">else</span>
    <span class="ident">base_node</span><span class="punct">.</span><span class="ident">parent</span><span class="punct">.</span><span class="ident">delete</span><span class="punct">(</span><span class="ident">base_node</span><span class="punct">)</span>
  <span class="keyword">end</span>

  <span class="ident">block_col</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">.</span><span class="ident">each</span><span class="punct">(&quot;</span><span class="string">*[not(starts-with(name(),'gs:'))]</span><span class="punct">&quot;)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">node</span><span class="punct">|</span>

    <span class="ident">container_name</span><span class="punct">,</span> <span class="ident">summary_var</span> <span class="punct">=</span> <span class="ident">node</span><span class="punct">.</span><span class="ident">name</span><span class="punct">.</span><span class="ident">split</span><span class="punct">('</span><span class="string">_</span><span class="punct">')</span>
    <span class="ident">element_container</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">container_name</span><span class="punct">)</span>
    <span class="ident">element_summary</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">summary</span><span class="punct">')</span>
    <span class="ident">element_records</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">records</span><span class="punct">')</span>
                
    <span class="ident">element_summary_var</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">summary_var</span><span class="punct">)</span>
    <span class="ident">xpath</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">entry[title='<span class="expr">#{node.text.to_s.upcase}</span>']/gs:cell</span><span class="punct">&quot;</span>
    <span class="ident">element_summary_var</span><span class="punct">.</span><span class="ident">text</span> <span class="punct">=</span>  <span class="ident">doc_cellfeed</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">(</span><span class="ident">xpath</span><span class="punct">)</span>

    <span class="ident">element_summary</span><span class="punct">.</span><span class="ident">add_element</span>  <span class="ident">element_summary_var</span>
    
    <span class="ident">element_container</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">element_summary</span>
     
    <span class="ident">element_container</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">element_records</span>
    <span class="ident">parent</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">element_container</span>
    <span class="keyword">if</span> <span class="ident">node</span><span class="punct">.</span><span class="ident">next_element</span> <span class="keyword">then</span>
      <span class="ident">parent</span> <span class="punct">=</span> <span class="ident">element_records</span> 
    <span class="keyword">else</span>
      <span class="ident">append_sections</span><span class="punct">(</span><span class="ident">doc</span><span class="punct">,</span> <span class="ident">doc_cellfeed</span><span class="punct">,</span> <span class="ident">element_records</span><span class="punct">,</span> <span class="ident">block_col</span><span class="punct">)</span>
    <span class="keyword">end</span>

  <span class="keyword">end</span>
  <span class="ident">prev_parent_text</span> <span class="punct">=</span> <span class="ident">base_node</span><span class="punct">.</span><span class="ident">text</span><span class="punct">.</span><span class="ident">to_s</span>

<span class="keyword">end</span>
 
<span class="ident">root</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">sheet</span><span class="punct">')</span>
<span class="ident">root_summary</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">summary</span><span class="punct">')</span>

<span class="ident">doc</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">elements</span><span class="punct">.</span><span class="ident">each</span><span class="punct">(&quot;</span><span class="string">gs:sheet/gs:summary/gs:*[starts-with(name(),'gs:sheet')]</span><span class="punct">&quot;)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">node</span><span class="punct">|</span>
  <span class="ident">summary_node</span> <span class="punct">=</span> <span class="constant">Element</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">node</span><span class="punct">.</span><span class="ident">name</span><span class="punct">[/</span><span class="regex">sheet_(.*)</span><span class="punct">/,</span><span class="number">1</span><span class="punct">])</span>
  <span class="ident">xpath</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">entry[title='<span class="expr">#{node.text.to_s.upcase}</span>']/gs:cell</span><span class="punct">&quot;</span>
  <span class="ident">summary_node</span><span class="punct">.</span><span class="ident">text</span> <span class="punct">=</span>  <span class="ident">doc_cellfeed</span><span class="punct">.</span><span class="ident">root</span><span class="punct">.</span><span class="ident">text</span><span class="punct">(</span><span class="ident">xpath</span><span class="punct">).</span><span class="ident">to_s</span>
  <span class="ident">root_summary</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">summary_node</span>
<span class="keyword">end</span>
<span class="ident">root</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">root_summary</span>
<span class="ident">root</span><span class="punct">.</span><span class="ident">add_element</span> <span class="ident">root_records</span>

<span class="constant">File</span><span class="punct">.</span><span class="ident">open</span><span class="punct">('</span><span class="string">exercise.xml</span><span class="punct">','</span><span class="string">w</span><span class="punct">'){|</span><span class="ident">f</span><span class="punct">|</span> <span class="ident">f</span><span class="punct">.</span><span class="ident">write</span> <span class="ident">root</span><span class="punct">}</span>
</pre><br /><br />output: file: <a href="http://rorbuilder.info/exercise.xml?passthru=1">exercise.xml</a> [rorbuilder.info]</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/template" class="tag ">template</a> <a href="/tag/xml" class="tag ">xml</a> <a href="/tag/convert" class="tag ">convert</a> <a href="/tag/google" class="tag ">google</a> <a href="/tag/rexml" class="tag ">rexml</a> <a href="/tag/health" class="tag ">health</a> <a href="/tag/spreadsheet" class="tag ">spreadsheet</a> <a href="/tag/exercise" class="tag ">exercise</a>  <!-- (110) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 18, 2009 <b></b>
	
	
		</div>
  </div>
</div>
<a name="post7048"></a>

<div id="post7048">
	<div class="post">
    <h3 class="post-title"><a href="/posts/show/7048">Generate a Google Chart with gchartrb</a></h3>

		<div class="post-body">Source: <a href="http://gchartrb.rubyforge.org/">gchartrb's gchartrb-0.8 Documentation</a> [rubyforge.org]<br /><br />Installation: sudo gem install gchartrb<br /><pre>
<span class="ident">require</span> <span class="punct">'</span><span class="string">rubygems</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">google_chart</span><span class="punct">'</span>

<span class="comment"># Pie Chart</span>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">PieChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">320x200</span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">Pie Chart</span><span class="punct">&quot;,</span><span class="constant">false</span><span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">pc</span><span class="punct">|</span>
  <span class="ident">pc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Apples</span><span class="punct">&quot;,</span> <span class="number">40</span>
  <span class="ident">pc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Banana</span><span class="punct">&quot;,</span> <span class="number">20</span>
  <span class="ident">pc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Peach</span><span class="punct">&quot;,</span> <span class="number">30</span>
  <span class="ident">pc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Orange</span><span class="punct">&quot;,</span> <span class="number">60</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Pie Chart</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">pc</span><span class="punct">.</span><span class="ident">to_url</span>

  <span class="comment"># Pie Chart with no labels</span>
  <span class="ident">pc</span><span class="punct">.</span><span class="ident">show_labels</span> <span class="punct">=</span> <span class="constant">false</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Pie Chart (with no labels)</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">pc</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Pie Chart<br />http://chart.apis.google.com/chart?chtt=Pie+Chart&amp;cht=p&amp;chl=Apples|Banana|Peach|Orange&amp;chd=s:oUe9&amp;chs=320x200<br /><br />Pie Chart (with no labels)<br />http://chart.apis.google.com/chart?chtt=Pie+Chart&amp;cht=p&amp;chd=s:oUe9&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::PieChart:0xb7a56c04 @colors=[], @data_encoding=:simple, @chart_type=:p, @line_styles=[], @data=[40, 20, 30, 60], @show_labels=false, @chart_size="320x200", @markers=[], @show_legend=false, @labels=["Apples", "Banana", "Peach", "Orange"], @axis=[], @params={:chtt=&gt;"Pie Chart", :cht=&gt;:p, :chd=&gt;"s:oUe9", :chs=&gt;"320x200"}, @chart_title="Pie Chart"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174005/">Screenshot of the Pie Chart</a> [twitxr.com] - <a href="http://chart.apis.google.com/chart?chtt=Pie+Chart&amp;cht=p&amp;chl=Apples|Banana|Peach|Orange&amp;chd=s:oUe9&amp;chs=320x200">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Line Chart</span>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">LineChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">320x200</span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">Line Chart</span><span class="punct">&quot;,</span> <span class="constant">false</span><span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">lc</span><span class="punct">|</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 1</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">1</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">0000ff</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">show_legend</span> <span class="punct">=</span> <span class="constant">true</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 2</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">1</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">00ff00</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 3</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">6</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">1</span><span class="punct">],</span> <span class="punct">'</span><span class="string">ff0000</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">axis</span> <span class="symbol">:y</span><span class="punct">,</span> <span class="symbol">:range</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">ff00ff</span><span class="punct">',</span> <span class="symbol">:font_size</span> <span class="punct">=&gt;</span> <span class="number">16</span><span class="punct">,</span> <span class="symbol">:alignment</span> <span class="punct">=&gt;</span> <span class="symbol">:center</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">axis</span> <span class="symbol">:x</span><span class="punct">,</span> <span class="symbol">:range</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">00ffff</span><span class="punct">',</span> <span class="symbol">:font_size</span> <span class="punct">=&gt;</span> <span class="number">16</span><span class="punct">,</span> <span class="symbol">:alignment</span> <span class="punct">=&gt;</span> <span class="symbol">:center</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">grid</span> <span class="symbol">:x_step</span> <span class="punct">=&gt;</span> <span class="number">100.0</span><span class="punct">/</span><span class="number">6.0</span><span class="punct">,</span> <span class="symbol">:y_step</span> <span class="punct">=&gt;</span> <span class="number">100.0</span><span class="punct">/</span><span class="number">6.0</span><span class="punct">,</span> <span class="symbol">:length_segment</span> <span class="punct">=&gt;</span> <span class="number">1</span><span class="punct">,</span> <span class="symbol">:length_blank</span> <span class="punct">=&gt;</span> <span class="number">0</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line Chart</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">lc</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Line Chart<br />http://chart.apis.google.com/chart?chco=0000ff,00ff00,ff0000&amp;chdl=Trend+1|Trend+2|Trend+3&amp;chxr=0,0,6|1,0,6&amp;chtt=Line+Chart&amp;chxs=0,ff00ff,16,0|1,00ffff,16,0&amp;chg=16.6666666666667,16.6666666666667,1.0,0.0&amp;chxt=y,x&amp;cht=lc&amp;chd=s:yoeKey9,KUeoy9,9yoeUK&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::LineChart:0xb7a293f8 @colors=["0000ff", "00ff00", "ff0000"], @data_encoding=:simple, @chart_type=:lc, @line_styles=[], @data=[[5, 4, 3, 1, 3, 5, 6], [1, 2, 3, 4, 5, 6], [6, 5, 4, 3, 2, 1]], @chart_size="320x200", @markers=[], @grid_str="16.6666666666667,16.6666666666667,1.0,0.0", @show_legend=true, @labels=["Trend 1", "Trend 2", "Trend 3"], @is_xy=false, @axis=[[:y, {:range=&gt;[0, 6], :font_size=&gt;16, :alignment=&gt;:center, :color=&gt;"ff00ff"}], [:x, {:range=&gt;[0, 6], :font_size=&gt;16, :alignment=&gt;:center, :color=&gt;"00ffff"}]], @params={:chco=&gt;"0000ff,00ff00,ff0000", :chdl=&gt;"Trend 1|Trend 2|Trend 3", :chxr=&gt;"0,0,6|1,0,6", :chtt=&gt;"Line Chart", :chxs=&gt;"0,ff00ff,16,0|1,00ffff,16,0", :chg=&gt;"16.6666666666667,16.6666666666667,1.0,0.0", :chxt=&gt;"y,x", :cht=&gt;:lc, :chd=&gt;"s:yoeKey9,KUeoy9,9yoeUK", :chs=&gt;"320x200"}, @chart_title="Line Chart"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174006/">Screenshot of the Line Chart</a> [twitxr.com] - <a href="http://tinyurl.com/ddctw7">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Bar Chart</span>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">BarChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">800x200</span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">Bar Chart</span><span class="punct">&quot;,</span> <span class="symbol">:vertical</span><span class="punct">,</span> <span class="constant">false</span><span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">bc</span><span class="punct">|</span>
  <span class="ident">bc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 1</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">1</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">5</span><span class="punct">],</span> <span class="punct">'</span><span class="string">0000ff</span><span class="punct">'</span>
  <span class="ident">bc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 2</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">1</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">ff0000</span><span class="punct">'</span>
  <span class="ident">bc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 3</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">6</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">00ff00</span><span class="punct">'</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Bar Chart</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">bc</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Bar Chart<br />http://chart.apis.google.com/chart?chco=0000ff,ff0000,00ff00&amp;chdl=Trend+1|Trend+2|Trend+3&amp;chtt=Bar+Chart&amp;cht=bvg&amp;chd=s:yoeKey,KUeoy9,9yooy9&amp;chs=800x200<br />=&gt; #&lt;GoogleChart::BarChart:0xb7a115b4 @stacked=false, @colors=["0000ff", "ff0000", "00ff00"], @data_encoding=:simple, @chart_type=:bvg, @line_styles=[], @alignment=:vertical, @data=[[5, 4, 3, 1, 3, 5], [1, 2, 3, 4, 5, 6], [6, 5, 4, 4, 5, 6]], @chart_size="800x200", @markers=[], @show_legend=true, @labels=["Trend 1", "Trend 2", "Trend 3"], @axis=[], @params={:chco=&gt;"0000ff,ff0000,00ff00", :chdl=&gt;"Trend 1|Trend 2|Trend 3", :chtt=&gt;"Bar Chart", :cht=&gt;:bvg, :chd=&gt;"s:yoeKey,KUeoy9,9yooy9", :chs=&gt;"800x200"}, @chart_title="Bar Chart"&gt;<br /><br /></pre><br /><a href="http://twitxr.com/image/174008/">Screenshot of the Bar Chart</a> [twitxr.com] - <a href="http://tinyurl.com/cne66d">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Line XY Chart</span>
<span class="ident">line_chart_xy</span> <span class="punct">=</span> <span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">LineChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">320x200</span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">Line XY Chart</span><span class="punct">&quot;,</span> <span class="constant">true</span><span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">lcxy</span><span class="punct">|</span>
  <span class="ident">lcxy</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 1</span><span class="punct">&quot;,</span> <span class="punct">[[</span><span class="number">1</span><span class="punct">,</span><span class="number">1</span><span class="punct">],</span> <span class="punct">[</span><span class="number">2</span><span class="punct">,</span><span class="number">2</span><span class="punct">],</span> <span class="punct">[</span><span class="number">3</span><span class="punct">,</span><span class="number">3</span><span class="punct">],</span> <span class="punct">[</span><span class="number">4</span><span class="punct">,</span><span class="number">4</span><span class="punct">]],</span> <span class="punct">'</span><span class="string">0000ff</span><span class="punct">'</span>
  <span class="ident">lcxy</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 2</span><span class="punct">&quot;,</span> <span class="punct">[[</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">],</span> <span class="punct">[</span><span class="number">2</span><span class="punct">,</span><span class="number">2</span><span class="punct">],</span> <span class="punct">[</span><span class="number">1</span><span class="punct">,</span><span class="number">1</span><span class="punct">],</span> <span class="punct">[</span><span class="number">3</span><span class="punct">,</span><span class="number">4</span><span class="punct">]],</span> <span class="punct">'</span><span class="string">00ff00</span><span class="punct">'</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line XY Chart (inside a block)</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">lcxy</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Line XY Chart (inside a block)<br />http://chart.apis.google.com/chart?chco=0000ff,00ff00&amp;chdl=Trend+1|Trend+2&amp;chtt=Line+XY+Chart&amp;cht=lxy&amp;chd=s:Pet9,MYkw,9ePt,9YMw&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::LineChart:0xb79f9a90 @colors=["0000ff", "00ff00"], @data_encoding=:simple, @chart_type=:lxy, @line_styles=[], @data=[[[1, 1], [2, 2], [3, 3], [4, 4]], [[4, 5], [2, 2], [1, 1], [3, 4]]], @chart_size="320x200", @markers=[], @show_legend=true, @labels=["Trend 1", "Trend 2"], @is_xy=true, @axis=[], @params={:chco=&gt;"0000ff,00ff00", :chdl=&gt;"Trend 1|Trend 2", :chtt=&gt;"Line XY Chart", :cht=&gt;:lxy, :chd=&gt;"s:Pet9,MYkw,9ePt,9YMw", :chs=&gt;"320x200"}, @chart_title="Line XY Chart"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174011/">Screenshot of the Line XY Chart</a> [twitxr.com] - <a href="http://tinyurl.com/c8o3ah">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Venn Diagram</span>
<span class="comment"># Supply three vd.data statements of label, size, color for circles A, B, C</span>
<span class="comment"># Then, an :intersections with four values:</span>
<span class="comment"># the first value specifies the area of A intersecting B</span>
<span class="comment"># the second value specifies the area of B intersecting C</span>
<span class="comment"># the third value specifies the area of C intersecting A</span>
<span class="comment"># the fourth value specifies the area of A intersecting B intersecting C</span>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">VennDiagram</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(&quot;</span><span class="string">320x200</span><span class="punct">&quot;,</span> <span class="punct">'</span><span class="string">Venn Diagram</span><span class="punct">')</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">vd</span><span class="punct">|</span>
  <span class="ident">vd</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Blue</span><span class="punct">&quot;,</span> <span class="number">100</span><span class="punct">,</span> <span class="punct">'</span><span class="string">0000ff</span><span class="punct">'</span>
  <span class="ident">vd</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Green</span><span class="punct">&quot;,</span> <span class="number">80</span><span class="punct">,</span> <span class="punct">'</span><span class="string">00ff00</span><span class="punct">'</span>
  <span class="ident">vd</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Red</span><span class="punct">&quot;,</span>   <span class="number">60</span><span class="punct">,</span> <span class="punct">'</span><span class="string">ff0000</span><span class="punct">'</span>
  <span class="ident">vd</span><span class="punct">.</span><span class="ident">intersections</span> <span class="number">30</span><span class="punct">,</span><span class="number">30</span><span class="punct">,</span><span class="number">30</span><span class="punct">,</span><span class="number">10</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Venn Diagram</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">vd</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Venn Diagram<br />http://chart.apis.google.com/chart?chco=0000ff,00ff00,ff0000&amp;chdl=Blue|Green|Red&amp;chtt=Venn+Diagram&amp;cht=v&amp;chd=s:9wkSSSG&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::VennDiagram:0xb79dc134 @colors=["0000ff", "00ff00", "ff0000"], @data_encoding=:simple, @chart_type=:v, @line_styles=[], @data=[100, 80, 60], @chart_size="320x200", @markers=[], @intersections=[30, 30, 30, 10], @show_legend=true, @labels=["Blue", "Green", "Red"], @axis=[], @params={:chco=&gt;"0000ff,00ff00,ff0000", :chdl=&gt;"Blue|Green|Red", :chtt=&gt;"Venn Diagram", :cht=&gt;:v, :chd=&gt;"s:9wkSSSG", :chs=&gt;"320x200"}, @chart_title="Venn Diagram"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174009/">Screenshot of the Venn Diagram</a> [twitxr.com] - <a href="http://tinyurl.com/cyenrt">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Scatter Chart</span>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">ScatterChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">320x200</span><span class="punct">',&quot;</span><span class="string">Scatter Chart</span><span class="punct">&quot;)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">sc</span><span class="punct">|</span>
  <span class="ident">sc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Scatter Set</span><span class="punct">&quot;,</span> <span class="punct">[[</span><span class="number">1</span><span class="punct">,</span><span class="number">1</span><span class="punct">,],</span> <span class="punct">[</span><span class="number">2</span><span class="punct">,</span><span class="number">2</span><span class="punct">],</span> <span class="punct">[</span><span class="number">3</span><span class="punct">,</span><span class="number">3</span><span class="punct">],</span> <span class="punct">[</span><span class="number">4</span><span class="punct">,</span><span class="number">4</span><span class="punct">]]</span>
  <span class="ident">sc</span><span class="punct">.</span><span class="ident">max_value</span> <span class="punct">[</span><span class="number">5</span><span class="punct">,</span><span class="number">5</span><span class="punct">]</span> <span class="comment"># Setting the max value</span>
  <span class="ident">sc</span><span class="punct">.</span><span class="ident">axis</span> <span class="symbol">:x</span><span class="punct">,</span> <span class="symbol">:range</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">5</span><span class="punct">]</span>
  <span class="ident">sc</span><span class="punct">.</span><span class="ident">axis</span> <span class="symbol">:y</span><span class="punct">,</span> <span class="symbol">:range</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">5</span><span class="punct">],</span> <span class="symbol">:labels</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">1</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">]</span>
  <span class="ident">sc</span><span class="punct">.</span><span class="ident">point_sizes</span> <span class="punct">[</span><span class="number">10</span><span class="punct">,</span><span class="number">15</span><span class="punct">,</span><span class="number">30</span><span class="punct">,</span><span class="number">55</span><span class="punct">]</span> <span class="comment"># Optional</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Scatter Chart</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">sc</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Scatter Chart<br />http://chart.apis.google.com/chart?chxr=0,0,5|1,0,5&amp;chtt=Scatter+Chart&amp;chxt=x,y&amp;cht=s&amp;chd=s:MYkw,MYkw,LQh9&amp;chxl=1:|0|1|2|3|4|5&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::ScatterChart:0xb79be10c @colors=[], @data_encoding=:simple, @max_y=5, @chart_type=:s, @line_styles=[], @data=[[[1, 1], [2, 2], [3, 3], [4, 4]]], @max_x=5, @chart_size="320x200", @markers=[], @show_legend=false, @labels=["Scatter Set"], @point_sizes=[10, 15, 30, 55], @axis=[[:x, {:range=&gt;[0, 5]}], [:y, {:range=&gt;[0, 5], :labels=&gt;[0, 1, 2, 3, 4, 5]}]], @params={:chxr=&gt;"0,0,5|1,0,5", :chtt=&gt;"Scatter Chart", :chxt=&gt;"x,y", :cht=&gt;:s, :chd=&gt;"s:MYkw,MYkw,LQh9", :chxl=&gt;"1:|0|1|2|3|4|5", :chs=&gt;"320x200"}, @chart_title="Scatter Chart"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174012/">Screenshot of the Scatter Chart</a> [twitxr.com] - <a href="http://tinyurl.com/cwv6eb">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">LineChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">320x200</span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">Line Chart</span><span class="punct">&quot;,</span> <span class="constant">false</span><span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">lc</span><span class="punct">|</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 1</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">1</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">0000ff</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">show_legend</span> <span class="punct">=</span> <span class="constant">true</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 2</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">1</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">00ff00</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 3</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">6</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">1</span><span class="punct">],</span> <span class="punct">'</span><span class="string">ff0000</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">axis</span> <span class="symbol">:y</span><span class="punct">,</span> <span class="symbol">:range</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">ff00ff</span><span class="punct">',</span> <span class="symbol">:font_size</span> <span class="punct">=&gt;</span> <span class="number">16</span><span class="punct">,</span> <span class="symbol">:alignment</span> <span class="punct">=&gt;</span> <span class="symbol">:center</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">axis</span> <span class="symbol">:x</span><span class="punct">,</span> <span class="symbol">:range</span> <span class="punct">=&gt;</span> <span class="punct">[</span><span class="number">0</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">00ffff</span><span class="punct">',</span> <span class="symbol">:font_size</span> <span class="punct">=&gt;</span> <span class="number">16</span><span class="punct">,</span> <span class="symbol">:alignment</span> <span class="punct">=&gt;</span> <span class="symbol">:center</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">grid</span> <span class="symbol">:x_step</span> <span class="punct">=&gt;</span> <span class="number">100.0</span><span class="punct">/</span><span class="number">6.0</span><span class="punct">,</span> <span class="symbol">:y_step</span> <span class="punct">=&gt;</span> <span class="number">100.0</span><span class="punct">/</span><span class="number">6.0</span><span class="punct">,</span> <span class="symbol">:length_segment</span> <span class="punct">=&gt;</span> <span class="number">1</span><span class="punct">,</span> <span class="symbol">:length_blank</span> <span class="punct">=&gt;</span> <span class="number">0</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line Chart</span><span class="punct">&quot;</span>
  <span class="ident">puts</span> <span class="ident">lc</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />Line Chart<br />http://chart.apis.google.com/chart?chco=0000ff,00ff00,ff0000&amp;chdl=Trend+1|Trend+2|Trend+3&amp;chxr=0,0,6|1,0,6&amp;chtt=Line+Chart&amp;chxs=0,ff00ff,16,0|1,00ffff,16,0&amp;chg=16.6666666666667,16.6666666666667,1.0,0.0&amp;chxt=y,x&amp;cht=lc&amp;chd=s:yoeKey9,KUeoy9,9yoeUK&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::LineChart:0xb7b32b78 @colors=["0000ff", "00ff00", "ff0000"], @data_encoding=:simple, @chart_type=:lc, @line_styles=[], @data=[[5, 4, 3, 1, 3, 5, 6], [1, 2, 3, 4, 5, 6], [6, 5, 4, 3, 2, 1]], @chart_size="320x200", @markers=[], @grid_str="16.6666666666667,16.6666666666667,1.0,0.0", @show_legend=true, @labels=["Trend 1", "Trend 2", "Trend 3"], @is_xy=false, @axis=[[:y, {:range=&gt;[0, 6], :font_size=&gt;16, :alignment=&gt;:center, :color=&gt;"ff00ff"}], [:x, {:range=&gt;[0, 6], :font_size=&gt;16, :alignment=&gt;:center, :color=&gt;"00ffff"}]], @params={}, @chart_title="Line Chart"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174014/">Screenshot of the Line Chart</a> [twitxr.com] - <a href="http://tinyurl.com/ddctw7">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Solid fill</span>
<span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">fill</span><span class="punct">(</span><span class="symbol">:background</span><span class="punct">,</span> <span class="symbol">:solid</span><span class="punct">,</span> <span class="punct">{</span><span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">fff2cc</span><span class="punct">'})</span>
<span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">fill</span><span class="punct">(</span><span class="symbol">:chart</span><span class="punct">,</span> <span class="symbol">:solid</span><span class="punct">,</span> <span class="punct">{</span><span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">ffcccc</span><span class="punct">'})</span>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line Chart with Solid Fill</span><span class="punct">&quot;</span>
<span class="ident">puts</span> <span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">to_url</span>
</pre><br />output:<br /><pre><br />http://chart.apis.google.com/chart?chco=0000ff,00ff00&amp;chdl=Trend+1|Trend+2&amp;chtt=Line+XY+Chart&amp;chf=bg,s,fff2cc|c,s,ffcccc&amp;cht=lxy&amp;chd=s:Pet9,MYkw,9ePt,9YMw&amp;chs=320x200<br /></pre><br /><a href="http://twitxr.com/image/174015/">Screenshot of the Linx XY Chart with pink fill</a> [twitxr.com] - <a href="http://tinyurl.com/de4smp">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Gradient fill</span>
<span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">fill</span> <span class="symbol">:background</span><span class="punct">,</span> <span class="symbol">:gradient</span><span class="punct">,</span> <span class="symbol">:angle</span> <span class="punct">=&gt;</span> <span class="number">0</span><span class="punct">,</span>  <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">[['</span><span class="string">76A4FB</span><span class="punct">',</span><span class="number">1</span><span class="punct">],['</span><span class="string">ffffff</span><span class="punct">',</span><span class="number">0</span><span class="punct">]]</span>
<span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">fill</span> <span class="symbol">:chart</span><span class="punct">,</span> <span class="symbol">:gradient</span><span class="punct">,</span> <span class="symbol">:angle</span> <span class="punct">=&gt;</span> <span class="number">0</span><span class="punct">,</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">[['</span><span class="string">76A4FB</span><span class="punct">',</span><span class="number">1</span><span class="punct">],</span> <span class="punct">['</span><span class="string">ffffff</span><span class="punct">',</span><span class="number">0</span><span class="punct">]]</span>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line Chart with Gradient Fill</span><span class="punct">&quot;</span>
<span class="ident">puts</span> <span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">to_url</span>
</pre><br />output:<br /><pre><br />http://chart.apis.google.com/chart?chco=0000ff,00ff00&amp;chdl=Trend+1|Trend+2&amp;chtt=Line+XY+Chart&amp;chf=bg,lg,0,76A4FB,1,ffffff,0|c,lg,0,76A4FB,1,ffffff,0&amp;cht=lxy&amp;chd=s:Pet9,MYkw,9ePt,9YMw&amp;chs=320x200<br /></pre><br /><a href="http://twitxr.com/image/174018/">Screenshot of the Line X Y Chart with a gradient background</a> [twitxr.com] - <a href="http://tinyurl.com/cceklr">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="comment"># Stripes Fill</span>
<span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">fill</span> <span class="symbol">:chart</span><span class="punct">,</span> <span class="symbol">:stripes</span><span class="punct">,</span> <span class="symbol">:angle</span> <span class="punct">=&gt;</span> <span class="number">90</span><span class="punct">,</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">[['</span><span class="string">76A4FB</span><span class="punct">',</span><span class="number">0.2</span><span class="punct">],</span> <span class="punct">['</span><span class="string">ffffff</span><span class="punct">',</span><span class="number">0.2</span><span class="punct">]]</span>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line Chart with Stripes Fill</span><span class="punct">&quot;</span>
<span class="ident">puts</span> <span class="ident">line_chart_xy</span><span class="punct">.</span><span class="ident">to_url</span>
</pre><br />output:<br /><pre><br />http://chart.apis.google.com/chart?chco=0000ff,00ff00&amp;chdl=Trend+1|Trend+2&amp;chtt=Line+XY+Chart&amp;chf=bg,lg,0,76A4FB,1,ffffff,0|c,ls,90,76A4FB,0.2,ffffff,0.2&amp;cht=lxy&amp;chd=s:Pet9,MYkw,9ePt,9YMw&amp;chs=320x200<br /></pre><br /><a href="http://twitxr.com/image/174022/">Screenshot of the Line X Y Chart with striped background</a> [twitxr.com] - <a href="http://tinyurl.com/cbdtav">generated with the Google Charts API</a> [google.com]<br /><br /><pre>
<span class="ident">puts</span> <span class="punct">&quot;</span><span class="string"><span class="escape">\n</span>Line Chart with range markers and shape markers</span><span class="punct">&quot;</span>
<span class="constant">GoogleChart</span><span class="punct">::</span><span class="constant">LineChart</span><span class="punct">.</span><span class="ident">new</span><span class="punct">('</span><span class="string">320x200</span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">Line Chart</span><span class="punct">&quot;,</span> <span class="constant">false</span><span class="punct">)</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">lc</span><span class="punct">|</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">title_color</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">ff00ff</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 1</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">1</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">0000ff</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 2</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">1</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">6</span><span class="punct">],</span> <span class="punct">'</span><span class="string">00ff00</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">data</span> <span class="punct">&quot;</span><span class="string">Trend 3</span><span class="punct">&quot;,</span> <span class="punct">[</span><span class="number">6</span><span class="punct">,</span><span class="number">5</span><span class="punct">,</span><span class="number">4</span><span class="punct">,</span><span class="number">3</span><span class="punct">,</span><span class="number">2</span><span class="punct">,</span><span class="number">1</span><span class="punct">],</span> <span class="punct">'</span><span class="string">ff0000</span><span class="punct">'</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">max_value</span> <span class="number">10</span> <span class="comment"># Setting max value for simple line chart</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">range_marker</span> <span class="symbol">:horizontal</span><span class="punct">,</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">E5ECF9</span><span class="punct">',</span> <span class="symbol">:start_point</span> <span class="punct">=&gt;</span> <span class="number">0.1</span><span class="punct">,</span> <span class="symbol">:end_point</span> <span class="punct">=&gt;</span> <span class="number">0.5</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">range_marker</span> <span class="symbol">:vertical</span><span class="punct">,</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">a0bae9</span><span class="punct">',</span> <span class="symbol">:start_point</span> <span class="punct">=&gt;</span> <span class="number">0.1</span><span class="punct">,</span> <span class="symbol">:end_point</span> <span class="punct">=&gt;</span> <span class="number">0.5</span>
  <span class="comment"># Draw an arrow shape marker against lowest value in dataset</span>
  <span class="ident">lc</span><span class="punct">.</span><span class="ident">shape_marker</span> <span class="symbol">:arrow</span><span class="punct">,</span> <span class="symbol">:color</span> <span class="punct">=&gt;</span> <span class="punct">'</span><span class="string">000000</span><span class="punct">',</span> <span class="symbol">:data_set_index</span> <span class="punct">=&gt;</span> <span class="number">0</span><span class="punct">,</span> <span class="symbol">:data_point_index</span> <span class="punct">=&gt;</span> <span class="number">3</span><span class="punct">,</span> <span class="symbol">:pixel_size</span> <span class="punct">=&gt;</span> <span class="number">10</span>
  <span class="ident">puts</span> <span class="ident">lc</span><span class="punct">.</span><span class="ident">to_url</span>
<span class="keyword">end</span>
</pre><br />output:<br /><pre><br />http://chart.apis.google.com/chart?chm=r,E5ECF9,0,0.1,0.5|R,a0bae9,0,0.1,0.5|a,000000,0,3,10&amp;chco=0000ff,00ff00,ff0000&amp;chdl=Trend+1|Trend+2|Trend+3&amp;chtt=Line+Chart&amp;chts=ff00ff&amp;cht=lc&amp;chd=s:eYSGSek,GMSYek,keYSMG&amp;chs=320x200<br />=&gt; #&lt;GoogleChart::LineChart:0xb7a2f708 @colors=["0000ff", "00ff00", "ff0000"], @data_encoding=:simple, @chart_type=:lc, @line_styles=[], @data=[[5, 4, 3, 1, 3, 5, 6], [1, 2, 3, 4, 5, 6], [6, 5, 4, 3, 2, 1]], @chart_size="320x200", @markers=["r,E5ECF9,0,0.1,0.5", "R,a0bae9,0,0.1,0.5", "a,000000,0,3,10"], @show_legend=true, @labels=["Trend 1", "Trend 2", "Trend 3"], @title_color="ff00ff", @is_xy=false, @axis=[], @max_data=10, @params={:chm=&gt;"r,E5ECF9,0,0.1,0.5|R,a0bae9,0,0.1,0.5|a,000000,0,3,10", :chco=&gt;"0000ff,00ff00,ff0000", :chdl=&gt;"Trend 1|Trend 2|Trend 3", :chtt=&gt;"Line Chart", :chts=&gt;"ff00ff", :cht=&gt;:lc, :chd=&gt;"s:eYSGSek,GMSYek,keYSMG", :chs=&gt;"320x200"}, @chart_title="Line Chart"&gt;<br /></pre><br /><a href="http://twitxr.com/image/174024/">Screenshot of the Line X Y Chart with a range marker</a> [twitxr.com] - <a href="http://tinyurl.com/dzaz96">generated with the Google Charts API</a> [google.com]<br /><br />Resources:<br /> - <a href="http://googlecharts.rubyforge.org/">Googlecharts</a> [rubyforge.org]<br /> - <a href="http://code.google.com/apis/chart/#chart_data">Developer's Guide - Google Chart API - Google Code</a> [google.com]</div>

		<div class="post-metadata">to <a href="/tag/ruby" class="tag ">ruby</a> <a href="/tag/google" class="tag ">google</a> <a href="/tag/line" class="tag ">line</a> <a href="/tag/api" class="tag ">api</a> <a href="/tag/graph" class="tag ">graph</a> <a href="/tag/bar" class="tag ">bar</a> <a href="/tag/chart" class="tag ">chart</a> <a href="/tag/pie" class="tag ">pie</a> <a href="/tag/gchartrb" class="tag ">gchartrb</a> <a href="/tag/scatter" class="tag ">scatter</a>  <!-- (172) --> by <a href="/user/jrobertson">jrobertson</a> on Mar 16, 2009 <b></b>
	
	
		</div>
  </div>
</div>

	
</div>

<div class="box grey paginator" style="text-align: center; color: #fff"><div style="float: left">
    <span class="disabled">&laquo; Newer Snippets</span></div><div style="float: right">
    <a href="/tag/ruby/2">Older Snippets &raquo;</a></div>Showing 1-10 of 1291 total <a title="RSS 2.0" href="/rss/tag/ruby"><span style="border:1px solid;border-color:#FC9 #630 #330 #F96;padding:1px 4px;font:bold 11px verdana,sans-serif;color:#FFF;background:#F60;text-decoration:none;margin:0px">&nbsp;RSS&nbsp;</span></a><br />
<div style="margin-top: 8px; "><form action="#"><select style="width: 250px" onchange="JumpToIt(this)">
 
 <option value="#post7102">Iterate through hash items in order</option>
 
 <option value="#post7099">module.lsp</option>
 
 <option value="#post7098">module.lsp</option>
 
 <option value="#post7088">Validate a TLD with Ruby</option>
 
 <option value="#post7086">chmodding and Ruby</option>
 
 <option value="#post7085">Scrape the 1st paragragh from a Wikipedia entry</option>
 
 <option value="#post7084">Strip the extra space out of a string using Ruby</option>
 
 <option value="#post7077">Retrieve a person's age from Wikipedia using Ruby</option>
 
 <option value="#post7059">Convert a Google Spreadsheet to XML</option>
 
 <option value="#post7048">Generate a Google Chart with gchartrb</option>
 
 </select></form>
     </div>

</div>




</div>

 	    <br style="clear: both" />

<div id="footer">
		<p>Snippets originally developed by <a href="http://www.petercooper.co.uk/">Peter Cooper</a> and powered by <a href="http://www.rubyonrails.com/">Ruby On Rails</a>.</p>
        <p>Copyright &copy; 2007 <a href="http://www.dzone.com">DZone, Inc.</a></p>
    <!-- Site Meter -->
	<script type="text/javascript" src="http://sm2.sitemeter.com/js/counter.js?site=sm2snippets">
	</script>
	<noscript>
	<a href="http://sm2.sitemeter.com/stats.asp?site=sm2snippets" target="_top">
	<img src="http://sm2.sitemeter.com/meter.asp?site=sm2snippets" alt="Site Meter" border="0"/></a>
	</noscript>
	<!-- Copyright (c)2006 Site Meter -->
</div>

    </div>
<script src="/javascripts/prototype.js?1229957682" type="text/javascript"></script>
		<script src="/javascripts/effects.js?1229957682" type="text/javascript"></script>
		<script src="/javascripts/dragdrop.js?1229957682" type="text/javascript"></script>
		<script src="/javascripts/controls.js?1229957682" type="text/javascript"></script>
		<script src="/javascripts/general.js?1229957682" type="text/javascript"></script>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-410289-8";
urchinTracker();
</script>
    <!-- Start Quantcast tag -->
    <script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script>
    <script type="text/javascript">
    _qacct="p-ebK_XdQH1HeLo";quantserve();</script>
    <noscript>
    <img src="http://pixel.quantserve.com/pixel/p-ebK_XdQH1HeLo.gif" style="display: none" height="1" width="1" alt="Quantcast"/></noscript>
    <!-- End Quantcast tag -->
     <script type="text/javascript" language="JavaScript" src="http://certify.alexametrics.com/atrk.js"></script>
<script type="text/javascript" language="JavaScript">_atrk_opts = {
atrk_acct: "2Zc291a0g0y12X" }; atrk ();</script>
<noscript><img src="http://certify.alexametrics.com/atrk.gif?account=2Zc291a0g0y12X&jsv=20080822" style="display:none" height="1" width="1"></noscript>
</body>
</html>
